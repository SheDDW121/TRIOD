# Проект по работе с хранителями и менеджером

Этот проект включает в себя систему с хранителями, менеджером, клиентом и витриной для загрузки и получения данных. Параметры запуска и конфигурации задаются в файле "config.py".

## Параметры конфигурации

Конфигурация системы задается в файле **config.py**. В этом файле можно настроить следующие параметры:

- num_storages - количество хранителей
- print_each_step - печатать ли информацию о том, как хранители и менеджер получают отдельные строки
- durability - установка очередей как durable или нет

- hash_prefix - префикс для хеширования хранителей
- ping_interval - интервал ping менеджера хранителей
- max_retries - максимальное количество повторных запросов ping прежде чем считаем, что узел "умер"
- print_only_if_dead - если False, то печатаем всю отладку, а не только если умер

- chunk_size - размер чанка (ключей в словаре), на которые разбиваем данные при падении одного из хранителей репликой
- print_every_chunk - если True, то печатаем детально все операции пересылки чанков

## Убийство хранителей

Для убийства хранителей можно отправить команду KILL <ID-хранителя> через клиента. Тогда клиент перебросит запрос менеджеру, а тот - нужному хранителю, и хранитель
завершит свою работу. Также при запуске хранителей выводится их PID, и написан скрипт kill_process.py. Можно запустить kill_process.py и дать ему PID процесса, и он убьет его.


## Запуск системы

Для запуска различных компонентов системы используйте следующие команды:

1. **Запуск хранителей с репликами:**
   ```bash
        python ./storageNode.py
   ```

2. **Запуск менеджера:**
   ```bash
        python ./final_manager.py
   ```

3. **Запуск клиента:**
   ```bash
        python ./client.py
   ```

4. **Запуск витрины:**
   ```bash
        python ./showcase.py
   ```
   
## Примеры команд клиента
Далее команды осуществляет клиент. Примеры команд:
  ```bash
    LOAD data/seattle-weather.csv
    LOAD data/testset.csv
    LOAD data/weather.csv
    LOAD data/weather_prediction_dataset.csv

    GET 01-01-2000
    GET 01-01-2012
    GET 31-12-2017
    GET ABSURD
    GET 2000-01-01

    KILL 2
    KILL 0
  ```

Пример связки команд для тестирования: (количество хранителей = 6):

```bash
    LOAD data/seattle-weather.csv
    LOAD data/testset.csv

    GET 01-01-2012 (ответит хранитель 4)

    KILL 4

    GET 01-01-2012 (ответит хранитель 2)

    KILL 2

    GET 01-01-2012 (ответит хранитель 5)

    LOAD data/seattle-weather.csv

    GET 01-01-2012 (ответит хранитель 5, данные добавятся в конец вывода)
  ```

## Витрина
Запускается отдельным процессом и классом, вместе с командой LOAD получает данные от менеджера и далее преобразует их в указанных вид.

Пример связки команд для тестирования работы витрины:

```bash
    temp_range 01-01-2012 11-01-2012 (будет написано, что витрина пустая)
    LOAD data/seattle-weather.csv
    temp_range 01-01-2012 11-01-2012 (будут выданы строки)
    temp_range_avg 01-01-2012 11-01-2012 (ответ - 6.141)
    temp_range 19-12-2015 31-12-2015 (будут выданы строки)
    temp_range_avg 19-12-2015 31-12-2015 (ответ - 3.777)

    LOAD data/testset.csv (чтобы данные пересекались)
    temp_range 01-01-2012 11-01-2012 (данные сильно изменятся)
    temp_range_avg 01-01-2012 11-01-2012 (ответ - 12.47)
    temp_range 19-12-2015 31-12-2015 (данные тоже изменятся)
    temp_range_avg 19-12-2015 31-12-2015 (ответ - 12.462)

    LOAD data/weather.csv
    temp_range 03-12-2016 10-01-2017
    temp_range_avg 03-12-2016 10-01-2017 (19.616)

    temp_range_avg 01-01-2012 11-01-2012 (12.47)
    LOAD data/seattle-weather.csv (11.778)
    LOAD data/seattle-weather.csv
    LOAD data/seattle-weather.csv
    LOAD data/seattle-weather.csv
    temp_range_avg 01-01-2012 11-01-2012 (10.391 - медленно идем к 6.141, что было раньше, плотность данных ниже, чем в testset.csv, поэтому так медленно)
```



